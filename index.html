–¢–æ—Å—è, [29.05.2025 1:53]
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .hidden { display: none; }
    .role-selection button { margin-right: 10px; padding: 10px 20px; }
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 6px; }
    th { background-color: #f0f0f0; }
  </style>
</head>
<body>

  <div class="role-selection">
    <button onclick="showStudent()">–í–æ–π—Ç–∏ –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç</button>
    <button onclick="showTeacher()">–í–æ–π—Ç–∏ –∫–∞–∫ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</button>
  </div>

  <!-- –°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞ -->
  <div id="studentFormBox" class="hidden">
    <h2>–§–æ—Ä–º–∞ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞</h2>
    <form id="studentForm">
      <input id="fio" placeholder="–§–ò–û" required><br>
      <input id="course" placeholder="–ö—É—Ä—Å" required><br>
      <input id="group" placeholder="–ì—Ä—É–ø–ø–∞" required><br>
      <input id="base" placeholder="–ë–∞–∑–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏"><br>
      <input id="baseAddress" placeholder="–ê–¥—Ä–µ—Å –±–∞–∑—ã"><br>
      <input id="basePhone" placeholder="–¢–µ–ª. –±–∞–∑—ã"><br>
      <input id="studentPhone" placeholder="–¢–µ–ª. —Å—Ç—É–¥–µ–Ω—Ç–∞"><br>
      <input id="orgSupervisor" placeholder="–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –Ω–∞ –±–∞–∑–µ"><br>
      <input id="practiceType" placeholder="–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏"><br>
      <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
  </div>

  <!-- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è -->
  <div id="teacherBox" class="hidden">
    <h2>–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>

    <div>
      <input id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û">
      <select id="filterCourse"><option value="">–í—Å–µ –∫—É—Ä—Å—ã</option></select>
      <select id="filterGroup"><option value="">–í—Å–µ –≥—Ä—É–ø–ø—ã</option></select>
      <select id="filterPracticeType"><option value="">–í—Å–µ –≤–∏–¥—ã –ø—Ä–∞–∫—Ç–∏–∫–∏</option></select>
      <button onclick="exportStudents()">–≠–∫—Å–ø–æ—Ä—Ç</button>
      <input type="file" id="importFile" accept=".json">
      <button onclick="importStudents()">–ò–º–ø–æ—Ä—Ç</button>
    </div>

    <table id="studentTable">
      <thead>
        <tr>
          <th>–§–ò–û</th><th>–ö—É—Ä—Å</th><th>–ì—Ä—É–ø–ø–∞</th><th>–ë–∞–∑–∞</th><th>–ê–¥—Ä–µ—Å</th>
          <th>–¢–µ–ª. –±–∞–∑—ã</th><th>–¢–µ–ª. —Å—Ç—É–¥–µ–Ω—Ç–∞</th><th>–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</th><th>–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏</th><th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
  const SHEET_URL = "https://script.google.com/macros/s/_–¢–í–û–ô_URL_–ó–î–ï–°–¨_/exec";
  let students = [];

  function showStudent() {
    document.getElementById("studentFormBox").classList.remove("hidden");
    document.getElementById("teacherBox").classList.add("hidden");
  }

  function showTeacher() {
    document.getElementById("teacherBox").classList.remove("hidden");
    document.getElementById("studentFormBox").classList.add("hidden");
    fetchStudents();
  }

  document.getElementById("studentForm")?.addEventListener("submit", function(e) {
    e.preventDefault();
    const student = {
      "–§–ò–û": fio.value.trim(),
      "–ö—É—Ä—Å": course.value.trim(),
      "–ì—Ä—É–ø–ø–∞": group.value.trim(),
      "–ë–∞–∑–∞": base.value.trim(),
      "–ê–¥—Ä–µ—Å": baseAddress.value.trim(),
      "–¢–µ–ª. –±–∞–∑—ã": basePhone.value.trim(),
      "–¢–µ–ª. —Å—Ç—É–¥–µ–Ω—Ç–∞": studentPhone.value.trim(),
      "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å": orgSupervisor.value.trim(),
      "–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏": practiceType.value.trim()
    };
    fetch(SHEET_URL, {
      method: "POST",
      headers: { "Content-Type": "text/plain" },
      body: JSON.stringify(student)
    })
    .then(r => r.text())
    .then(txt => {
      if (txt === "OK") {
        document.getElementById("studentFormBox").innerHTML = "<p>–°–ø–∞—Å–∏–±–æ! –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã.</p>";
      } else {
        alert("–û—à–∏–±–∫–∞: " + txt);
      }
    });
  });

  function fetchStudents() {
    fetch(SHEET_URL)
      .then(r => r.json())
      .then(data => {
        students = data;
        renderTable();
        updateFilters();
      });
  }

–¢–æ—Å—è, [29.05.2025 1:53]
function renderTable() {
    const search = searchInput().value.trim().toLowerCase();
    const course = filterCourse.value;
    const group = filterGroup.value;
    const practice = filterPracticeType.value;
    const tbody = document.querySelector("#studentTable tbody");
    tbody.innerHTML = "";

    students.forEach((s, i) => {
      if (search && !s["–§–ò–û"].toLowerCase().includes(search)) return;
      if (course && s["–ö—É—Ä—Å"] !== course) return;
      if (group && s["–ì—Ä—É–ø–ø–∞"] !== group) return;
      if (practice && s["–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏"] !== practice) return;

      const row = tbody.insertRow();
      ["–§–ò–û","–ö—É—Ä—Å","–ì—Ä—É–ø–ø–∞","–ë–∞–∑–∞","–ê–¥—Ä–µ—Å","–¢–µ–ª. –±–∞–∑—ã","–¢–µ–ª. —Å—Ç—É–¥–µ–Ω—Ç–∞","–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å","–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏"].forEach(key => {
        row.insertCell().textContent = s[key] || "";
      });
      const actions = row.insertCell();
      actions.innerHTML = <button onclick="editStudent(${i})">‚úèÔ∏è</button>
                           <button onclick="deleteStudent(${i})">üóëÔ∏è</button>;
    });
  }

  function updateFilters() {
    const courses = [...new Set(students.map(s => s["–ö—É—Ä—Å"]))].sort();
    const groups = [...new Set(students.map(s => s["–ì—Ä—É–ø–ø–∞"]))].sort();
    const types  = [...new Set(students.map(s => s["–í–∏–¥ –ø—Ä–∞–∫—Ç–∏–∫–∏"]))].sort();

    updateSelect(filterCourse, courses);
    updateSelect(filterGroup, groups);
    updateSelect(filterPracticeType, types);
  }

  function updateSelect(select, values) {
    select.innerHTML = <option value="">–í—Å–µ</option> + values.map(v => <option>${v}</option>).join('');
  }

  function editStudent(i) {
    const s = students[i];
    const fio = prompt("–§–ò–û", s["–§–ò–û"]);
    if (fio === null) return;
    students[i]["–§–ò–û"] = fio;
    renderTable();
  }

  function deleteStudent(i) {
    if (confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞?")) {
      students.splice(i, 1);
      renderTable();
    }
  }

  function exportStudents() {
    const blob = new Blob([JSON.stringify(students, null, 2)], { type: "application/json" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "students.json";
    link.click();
  }

  function importStudents() {
    const fileInput = document.getElementById("importFile");
    const file = fileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const imported = JSON.parse(e.target.result);
        if (!Array.isArray(imported)) {
          alert("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞.");
          return;
        }
        students = imported;
        renderTable();
        updateFilters();
      } catch (err) {
        alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: " + err.message);
      }
    };
    reader.readAsText(file);
  }

  function searchInput() {
    return document.getElementById("search") || { value: "" };
  }

  document.getElementById("search")?.addEventListener("input", renderTable);
  document.getElementById("filterCourse")?.addEventListener("change", renderTable);
  document.getElementById("filterGroup")?.addEventListener("change", renderTable);
  document.getElementById("filterPracticeType")?.addEventListener("change", renderTable);
</script>

</body>
</html>
